{% extends "base.twig" %}

{% block title %}Search{% endblock %}
{% block contents %}
    <div class="row">
        <article class="comments column">
            {% if comments %}
                {% for comment in comments %}
                    <section class="comment">
                        <header class="comment__header">
                            {% set isSigned = comment.user_name and comment.user_image_url %}
                            <div>
                                {% if isSigned %}
                                    <img src="{{ comment.user_image_url }}" alt="{{ comment.user_name }}">
                                {% else %}
                                    <img src="http://via.placeholder.com/64x64" alt="匿名ユーザー">
                                {% endif %}
                            </div>
                            <div>
                                {% if isSigned %}
                                    {{ comment.user_name }}:
                                {% else %}
                                    匿名ユーザー:
                                {% endif %}
                            </div>
                            <div>
                                {{ comment.created_at }}
                            </div>
                            <div>
                                そうだね&#215;<span id="{{ comment.comment_id }}_like">{{ comment.like_count }}</span>
                            </div>
                        </header>
                        <main class="comment__main">️
                            {{ comment.comment }}
                        </main>
                        <footer class="comment__footer">
                            {% if is_admin %}
                                <form action="{{ path_for('delete_comment') }}" method="post">
                                    <input type="hidden" name="comment_id" value="{{ comment.comment_id }}">
                                    <input type="hidden" name="thread_id" value="{{ comment.thread_id }}">
                                    <input type="hidden" name="{{ nameKey }}" value="{{ name }}">
                                    <input type="hidden" name="{{ valueKey }}" value="{{ value }}">
                                    <input type="hidden" name="query" value="{{ query }}">
                                    <input type="hidden" name="_METHOD" value="DELETE">
                                    <input type="submit" value="削除" class="button--small">
                                </form>
                            {% endif %}
                        </footer>
                    </section>
                {% endfor %}
            {% else %}
                <div class="content">
                    コメントがありません。
                </div>
            {% endif %}
        </article>
    </div>
{% endblock %}